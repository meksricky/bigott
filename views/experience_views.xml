<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Gift Experience Tree View -->
        <record id="view_gift_experience_tree" model="ir.ui.view">
            <field name="name">gift.experience.tree</field>
            <field name="model">gift.experience</field>
            <field name="arch" type="xml">
                <tree string="Gift Experiences" sample="1">
                    <field name="name"/>
                    <field name="experience_theme"/>
                    <field name="product_count"/>
                    <field name="base_cost" widget="monetary"/>
                    <field name="recommended_budget" widget="monetary"/>
                    <field name="times_used"/>
                    <field name="average_satisfaction" widget="percentage"/>
                    <field name="is_vegan_friendly"/>
                    <field name="is_halal_friendly"/>
                    <field name="is_alcohol_free"/>
                    <field name="active"/>
                </tree>
            </field>
        </record>
        
        <!-- Gift Experience Form View -->
        <record id="view_gift_experience_form" model="ir.ui.view">
            <field name="name">gift.experience.form</field>
            <field name="model">gift.experience</field>
            <field name="arch" type="xml">
                <form string="Gift Experience">
                    <header>
                        <button name="action_view_usage_history" 
                                string="ðŸ“Š View Usage History" 
                                type="object" 
                                class="btn-secondary"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="action_view_usage_history" 
                                    type="object" 
                                    class="oe_stat_button" 
                                    icon="fa-users">
                                <field name="times_used" widget="statinfo" 
                                       string="Times Used"/>
                            </button>
                            <button name="action_view_compositions" 
                                    type="object" 
                                    class="oe_stat_button" 
                                    icon="fa-star">
                                <field name="average_satisfaction" widget="statinfo" 
                                       string="Avg Satisfaction"/>
                            </button>
                        </div>
                        
                        <widget name="web_ribbon" title="Archived" bg_color="text-bg-danger" 
                                invisible="active == True"/>
                        
                        <div class="oe_title">
                            <h1>
                                <field name="name"/>
                            </h1>
                            <div class="o_row">
                                <field name="experience_theme"/>
                                <field name="active"/>
                            </div>
                        </div>
                        
                        <group>
                            <group name="experience_details" string="Experience Details">
                                <field name="product_count"/>
                                <field name="base_cost" widget="monetary"/>
                                <field name="recommended_budget" widget="monetary"/>
                                <field name="min_budget" widget="monetary"/>
                                <field name="max_budget" widget="monetary"/>
                                <field name="is_premium"/>
                            </group>
                            <group name="dietary_compatibility" string="Dietary Compatibility">
                                <field name="is_vegan_friendly"/>
                                <field name="is_halal_friendly"/>
                                <field name="is_alcohol_free"/>
                            </group>
                        </group>
                        
                        <group name="description_section" string="Description">
                            <field name="description" nolabel="1"/>
                        </group>
                        
                        <notebook>
                            <page string="Products" name="products">
                                <group name="products_section" string="Products in Experience">
                                    <field name="product_ids" nolabel="1">
                                        <tree editable="bottom">
                                            <field name="name"/>
                                            <field name="lebiggot_category"/>
                                            <field name="list_price" widget="monetary"/>
                                            <field name="product_grade"/>
                                            <field name="brand"/>
                                            <field name="is_vegan"/>
                                            <field name="is_halal"/>
                                        </tree>
                                    </field>
                                </group>
                            </page>
                            
                            <page string="Instructions" name="instructions">
                                <group name="instructions_section" string="Preparation Instructions">
                                    <field name="instructions" nolabel="1"/>
                                </group>
                            </page>
                            
                            <page string="Usage History" name="usage_history">
                                <group name="usage_section" string="Client Usage History">
                                    <field name="client_usage_ids" nolabel="1" readonly="1">
                                        <tree>
                                            <field name="partner_id"/>
                                            <field name="order_year"/>
                                            <field name="total_budget" widget="monetary"/>
                                            <field name="client_satisfaction" widget="badge"/>
                                            <field name="notes"/>
                                        </tree>
                                    </field>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        
        <!-- Gift Experience Search View -->
        <record id="view_gift_experience_search" model="ir.ui.view">
            <field name="name">gift.experience.search</field>
            <field name="model">gift.experience</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name"/>
                    <field name="experience_theme"/>
                    <field name="product_ids"/>
                    
                    <filter name="active_experiences" string="Active" 
                            domain="[('active', '=', True)]"/>
                    <filter name="vegan_friendly" string="Vegan Friendly" 
                            domain="[('is_vegan_friendly', '=', True)]"/>
                    <filter name="halal_friendly" string="Halal Friendly" 
                            domain="[('is_halal_friendly', '=', True)]"/>
                    <filter name="alcohol_free" string="Alcohol Free" 
                            domain="[('is_alcohol_free', '=', True)]"/>
                    <filter name="premium_experiences" string="Premium" 
                            domain="[('is_premium', '=', True)]"/>
                    <filter name="popular_experiences" string="Popular (5+ uses)" 
                            domain="[('times_used', '>=', 5)]"/>
                    
                    <group expand="0" string="Group By">
                        <filter name="group_by_theme" string="Theme" context="{'group_by': 'experience_theme'}"/>
                        <filter name="group_by_active" string="Status" context="{'group_by': 'active'}"/>
                    </group>
                </search>
            </field>
        </record>
        
        <!-- Gift Experience Action -->
        <record id="action_gift_experience" model="ir.actions.act_window">
            <field name="name">Gift Experiences</field>
            <field name="res_model">gift.experience</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_active_experiences': 1}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    ðŸŽ¨ Create your first curated experience!
                </p>
                <p>
                    Design 3-5 product experiences with preparation instructions that SeÃ±or Bigott can recommend to clients.
                </p>
            </field>
        </record>
        
    </data>
</odoo>